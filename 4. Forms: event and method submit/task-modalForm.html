<!-- Modal form
importance: 5
Create a function showPrompt(html, callback) that shows a form with the message html, an input field and buttons OK/CANCEL.

A user should type something into a text field and press Enter or the OK button, then callback(value) is called with the value they entered.
Otherwise if the user presses Esc or CANCEL, then callback(null) is called.
In both cases that ends the input process and removes the form.

Requirements:

The form should be in the center of the window.
The form is modal. In other words, no interaction with the rest of the page is possible until the user closes it.
When the form is shown, the focus should be inside the <input> for the user.
Keys Tab/Shift+Tab should shift the focus between form fields, don’t allow it to leave for other page elements.
Usage example:

showPrompt("Enter something<br>...smart :)", function(value) {
  alert(value);
});
A demo in the iframe:


P.S. The source document has HTML/CSS for the form with fixed positioning, but it’s up to you to make it modal. -->

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <!-- <link rel="stylesheet" href="style.css"> -->

    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
      }

      #prompt-form {
        display: inline-block;
        padding: 5px 5px 5px 60px;
        width: 200px;
        border: 1px solid black;
        background: white url(https://en.js.cx/clipart/prompt.png) no-repeat
          left 5px;
        vertical-align: middle;
      }

      #prompt-form-container {
        position: fixed;
        top: 0;
        left: 0;
        z-index: 9999;
        display: none;
        width: 100%;
        height: 100%;
        text-align: center;
      }

      #prompt-form-container:before {
        display: inline-block;
        height: 100%;
        content: '';
        vertical-align: middle;
      }

      #cover-div {
        position: fixed;
        top: 0;
        left: 0;
        z-index: 9000;
        width: 100%;
        height: 100%;
        background-color: grey;
        opacity: 0.7;
      }

      #prompt-form input[name='text'] {
        display: block;
        margin: 5px;
        width: 180px;
      }
    </style>
  </head>

  <body style="height: 3000px">
    <h2>Click the button below</h2>

    <input type="button" value="Click to show the form" id="show-button" />

    <div id="prompt-form-container">
      <form id="prompt-form">
        <div id="prompt-message"></div>
        <input name="text" type="text" />
        <input type="submit" value="Ok" />
        <input type="button" name="cancel" value="Cancel" />
      </form>
    </div>

    <script>
      // Show a half-transparent DIV to "shadow" the page
      // (the form is not inside, but near it, because it shouldn't be half-transparent)
      function showCover() {
        let coverDiv = document.createElement('div');
        coverDiv.id = 'cover-div';

        // make the page unscrollable while the modal form is open
        document.body.style.overflowY = 'hidden';

        document.body.append(coverDiv);
      }

      function hideCover() {
        document.getElementById('cover-div').remove();
        document.body.style.overflowY = ''; //hide scroll Y
      }

      function showPrompt(text, callback) {
        showCover();
        let form = document.getElementById('prompt-form');
        let container = document.getElementById('prompt-form-container');
        document.getElementById('prompt-message').innerHTML = text;
        form.text.value = '';

        function complete(value) {
          hideCover();
          container.style.display = 'none'; //hide modal
          document.onkeydown = null; //hapus listener keyboard
          callback(value);
        }

        form.onsubmit = function () {
          let value = form.text.value; //ambil isi input dari user
          if (value == '') return false; // ignore empty submit. Jika kosong → jangan tutup modal

          complete(value);
          return false; //cegah reload halaman
        };

        //Handle cancel button
        form.cancel.onclick = function () {
          complete(null); //tutup modal tanpa value (null)
        };

        document.onkeydown = function (e) {
          if (e.key == 'Escape') {
            complete(null); //jika tekan ESC => tutup modal
          }
        };

        //Accessibility: beri focus dgn TAB trap (cegah focus TAB keluar modal)
        let lastElem = form.elements[form.elements.length - 1];
        let firstElem = form.elements[0]; //<input name='text'>. Coz form.elements hanya berisi form control, yaitu elemen yang berinteraksi dengan user.

        //VERSI MODERN
        // lastElem.addEventListener('keydown', function (e) {
        //   if (e.key === 'Tab' && !e.shiftKey) {
        //     e.preventDefault(); // Memastikan sejak awal default behavior dibatalkan. cegah tab keluar
        //     firstElem.focus(); // ganti behavior. putar fokus
        //   }
        // });

        //VERSI OLD SCHOOL
        lastElem.onkeydown = function (e) {
          if (e.key == 'Tab' && !e.shiftKey) {
            //Jika TAB ditekan di elemen terakhir, Fokus kembali ke elemen pertama
            firstElem.focus(); // shg mencegah Fokus keluar dari modal
            return false;
          }
        };

        firstElem.onkeydown = function (e) {
          if (e.key == 'Tab' && e.shiftKey) {
            lastElem.focus();
            return false;
          }
        };

        container.style.display = 'block'; //show modal
        form.elements.text.focus(); //Cursor langsung ke input
      }

      document.getElementById('show-button').onclick = function () {
        showPrompt('Enter something<br>...smart :)', function (value) {
          alert('You entered: ' + value);
        });
      };
    </script>
  </body>
</html>
